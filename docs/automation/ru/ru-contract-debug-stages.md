---
title: Этапы отладки контрактов (RU)
---

## Цель

Стандартизировать отладку методов, чтобы каждый метод проверялся на точное соответствие документированному контракту.

## Этап 1: Загрузка контракта

- Открыть спецификацию метода (каталог методов + шаблон метода).
- Подтвердить входы, выходы, side effects и error contract.

## Этап 2: Предусловия

- Проверить обязательное состояние (master node, session, permissions, config flags).
- Зафиксировать snapshot предусловий.

## Этап 3: Валидация входных данных

- Прогнать happy path.
- Прогнать некорректный формат входа.
- Прогнать отсутствие обязательного поля.
- Выполнить оба режима тестирования:
  - Автономный (script/API assertions).
  - Ручной (операторский сценарий).

## Этап 4: Проверка policy gate

- Прогнать low/medium/high risk.
- Прогнать с `human_approved` и без него.
- Подтвердить `allowed/denied` и корректный denial reason.

## Этап 5: Проверка выходного контракта

- Подтвердить shape ответа и обязательные поля.
- Подтвердить формат ошибок и status behavior.

## Этап 6: Проверка side effects

- Подтвердить ожидаемые изменения состояния (job/action/workflow).
- Подтвердить отсутствие нежелательных мутаций.

## Этап 7: Проверка наблюдаемости

- Подтвердить emission логов.
- Подтвердить наличие audit artifacts.

## Этап 8: Подписание результата

- Выставить статус: `pass` / `partial` / `fail`.
- Завести remediation-задачи по найденным нарушениям.
- Зафиксировать покрытие:
  - `autonomous_coverage`: % автоматизированных проверок контракта.
  - `manual_coverage`: % ручных проверок контракта.

## Практический чеклист прогона

### Автономный чеклист

- [ ] Контракт метода загружен, версия зафиксирована.
- [ ] Добавлены/обновлены автотесты по входам и policy gate.
- [ ] Проверены success/error ответы на соответствие контракту.
- [ ] Проверены side effects через asserts по данным.
- [ ] Логи и audit evidence сохранены как артефакты.

### Ручной чеклист

- [ ] Запущена тестовая среда (Docker Compose или WSL runbook).
- [ ] Пройден операторский сценарий end-to-end.
- [ ] Проверены deny-сценарии и эскалация на high risk.
- [ ] Подтверждено отсутствие регрессий в UI/операционном потоке.
- [ ] Заполнен execution evidence с ссылками на логи и задачи.
